---

- name: Install OpenShift Gitops
  ansible.builtin.include_tasks: openshift_gitops.yml

- name: Install OpenShift Pipelines
  ansible.builtin.include_tasks: openshift_pipelines.yml

- name: Install NooBaa
  ansible.builtin.include_tasks: noobaa.yml

- name: Install Vault
  ansible.builtin.include_tasks: vault.yml

- name: Install External Secrets
  ansible.builtin.include_tasks: external_secrets.yml

- name: Install Gitlab
  ansible.builtin.include_tasks: gitlab.yml

- name: Install RHBK
  ansible.builtin.include_tasks: keycloak.yml

- name: Install Quay
  ansible.builtin.include_tasks: quay.yml

- name: Install RHDH GitOps
  ansible.builtin.include_tasks: rhdh_gitops.yml

- name: Install multiple Red Hat Developer Hub instances
  ansible.builtin.include_tasks: redhat_developer_hub.yml
  loop:
    - ocp4_workload_platform_engineering_workshop_rhdh_name: rhdh-instance1
      ocp4_workload_platform_engineering_workshop_rhdh_namespace: rhdh-instance1
      ocp4_workload_platform_engineering_workshop_rhdh_argo_application_name: rhdh-instance1-bootstrap
      ocp4_workload_platform_engineering_workshop_rhbk_client_backstage_name: rhdh-instance1
    - ocp4_workload_platform_engineering_workshop_rhdh_name: rhdh-instance2
      ocp4_workload_platform_engineering_workshop_rhdh_namespace: rhdh-instance2
      ocp4_workload_platform_engineering_workshop_rhdh_argo_application_name: rhdh-instance2-bootstrap
      ocp4_workload_platform_engineering_workshop_rhbk_client_backstage_name: rhdh-instance2
  loop_control:
    loop_var: rhdh_instance
  vars:
    ocp4_workload_platform_engineering_workshop_rhdh_namespace: "{{ rhdh_instance.ocp4_workload_platform_engineering_workshop_rhdh_namespace }}"
    ocp4_workload_platform_engineering_workshop_rhdh_argo_application_name: "{{ rhdh_instance.ocp4_workload_platform_engineering_workshop_rhdh_argo_application_name }}"
    ocp4_workload_platform_engineering_workshop_rhdh_name: "{{ rhdh_instance.ocp4_workload_platform_engineering_workshop_rhdh_name }}"
    ocp4_workload_platform_engineering_workshop_rhbk_client_backstage_name: "{{ rhdh_instance.ocp4_workload_platform_engineering_workshop_rhbk_client_backstage_name }}"

- name: Install Trusted Artifact Signer
  ansible.builtin.include_tasks: trusted_artifact_signer.yml

# - name: Install Parasol
#   ansible.builtin.include_tasks: parasol.yml

# - name: Install Orchestrator
#   ansible.builtin.include_tasks: orchestrator.yml

- name: Print Common Password
  agnosticd_user_info:
    msg: "{{ item }}"
  loop:
    - ""
    - "password: {{ common_password }}"
